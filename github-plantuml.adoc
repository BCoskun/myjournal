= using github and plantuml
:author: David Buret
:source-highlighter: pygments
:pygments-style: emacs
:icons: font
:sectnums:
:toclevels: 4
:toc:
:imagesdir: images/
:toc-title: Sommaire
:gitplant: http://www.plantuml.com/plantuml/proxy?src=https://raw.githubusercontent.com/DBuret/myjournal/master/

== introduction

I'm currently moving to asciidoc and plantuml to write docs.
Github asciidoc parsing does not understand plantuml.

== solution

Use plantuml online server to parse the plantuml file on github, and use its full url in github asciidoc files
 
.image url 
http://www.plantuml.com/plantuml/proxy?src=https://raw.github.com/plantuml/plantuml-server/master/src/main/webapp/resource/test2diagrams.txt

.my test

[source]
----
image::http://www.plantuml.com/plantuml/proxy?src=https://raw.githubusercontent.com/DBuret/myjournal/master/test.puml[test]
----

syntax is very long, let's use an asciidoc variable +gitplant+

.how to display plantuml in asciidoc on github
[source]
----
:gitplant: http://www.plantuml.com/plantuml/proxy?src=https://raw.githubusercontent.com/DBuret/myjournal/master/

image::{gitplant}/test.puml[test]
----

=== Result

image::{gitplant}/test.puml[PlantUML Image]

TIP: Purge an image from githuib cache with: `curl -X PURG https://camo.githubusercontent.com/xxxxxxxxxxx`
